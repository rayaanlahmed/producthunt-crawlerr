<script>
function displayResults(products, rateLimited = []) {
  resultCount.textContent = `Found ${products.length} product${products.length !== 1 ? 's' : ''}`;

  let html = '';

  if (rateLimited && rateLimited.length > 0) {
    html += `
      <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
        <h3 style="margin: 0 0 10px 0; color: #856404;">‚ö†Ô∏è ${rateLimited.length} Product(s) Rate Limited</h3>
        <p style="margin: 0 0 15px 0; color: #856404;">These products couldn‚Äôt be scraped due to rate limiting:</p>
        <ul>${rateLimited.map(item => `<li>${item.name}</li>`).join('')}</ul>
      </div>
    `;
  }

  if (products.length === 0) {
    html += '<p style="text-align:center; color:#666; padding:20px;">No products found matching your criteria.</p>';
  } else {
    html += products.map((product, index) => `
      <div class="product-card">
        <div class="product-title">${escapeHtml(product.name)}</div>

        <!-- üîó Direct Links -->
        <div style="margin-bottom: 10px;">
          ${product.producthunt_url ? `<a href="${escapeHtml(product.producthunt_url)}" target="_blank" class="product-url">üîó View on Product Hunt</a><br>` : ''}
          ${product.url ? `<a href="${escapeHtml(product.url)}" target="_blank" class="product-url">üåê Official Website</a>` : ''}
        </div>

        <!-- üí¨ Summary -->
        ${product.tagline ? `<div class="product-description"><strong>Tagline:</strong> ${escapeHtml(product.tagline)}</div>` : ''}
        ${product.description ? `<div class="product-description"><strong>Description:</strong> ${escapeHtml(product.description)}</div>` : ''}

        <!-- üìä Meta -->
        <div class="product-meta">
          ${product.votes ? `<div class="meta-item"><strong>Popularity:</strong> ${product.votes} votes</div>` : ''}
          ${product.launchDate ? `<div class="meta-item"><strong>Launched:</strong> ${new Date(product.launchDate).toLocaleDateString()}</div>` : ''}
          ${product.score ? `<div class="meta-item"><strong>AI Evaluation Score:</strong> ${product.score}/100 üß†</div>` : ''}
        </div>

        <!-- üè∑ Topics -->
        ${product.topics ? `
          <div class="product-categories">
            ${product.topics.split(',').map(cat => `<span class="category-badge">${escapeHtml(cat.trim())}</span>`).join('')}
          </div>
        ` : ''}

        <!-- üë§ Founder -->
        ${product.founder ? `
          <div style="margin-top:10px;">
            <strong>Founder:</strong> ${escapeHtml(product.founder)}
            ${product.founderProfile ? ` - <a href="${escapeHtml(product.founderProfile)}" target="_blank" style="color:#0077B5;">LinkedIn</a>` : ''}
          </div>
        ` : ''}
      </div>
    `).join('');
  }

  productList.innerHTML = html;
  results.classList.add('active');
}

function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}
</script>

